# OP COLLECTION TYPES DEMO
# 8 powerful collection types that make J feel like cheating

out("========================================")
out("J LANGUAGE - OP COLLECTION TYPES")
out("========================================\n")

# Note: These are the type definitions - implementation coming soon!
# This demo shows the intended API and usage patterns

out("=== 1. QUEUE - Double-Ended Queue ===")
out("Fast O(1) push/pop from both ends")
out("Perfect for: BFS, sliding windows, undo/redo")
out("Example:")
out("  queue | q -> queue()")
out("  q.push(10)        # append right")
out("  q.push_left(5)    # append left")
out("  q.pop()           # remove right")
out("  q.pop_left()      # remove left")
out()

out("=== 2. RING - Circular Buffer ===")
out("Fixed capacity, auto-overwrite oldest")
out("Perfect for: rolling logs, fixed history, real-time buffers")
out("Example:")
out("  ring | log -> ring(capacity=100)")
out("  log.add('error 1')")
out("  log.tail(5)       # most recent 5")
out()

out("=== 3. SORTED - Auto-Sorted List ===")
out("Automatically kept sorted (balanced tree)")
out("Perfect for: leaderboards, priority data, range queries")
out("Example:")
out("  sorted | scores -> sorted()")
out("  scores.add(85)")
out("  scores.add(92)    # auto-inserted in order")
out("  scores[0]         # lowest")
out("  scores[-1]        # highest")
out()

out("=== 4. BAG - Multiset ===")
out("Counts duplicates automatically")
out("Perfect for: frequency counting, inventory, anagrams")
out("Example:")
out("  bag | fruits -> bag()")
out("  fruits.add('apple')")
out("  fruits.add('apple')")
out("  fruits.count('apple')  # 2")
out("  fruits.most_common(2)")
out()

out("=== 5. WINDOW - Sliding Window View ===")
out("Zero-copy sublists that move automatically")
out("Perfect for: time-series, monitoring, rolling stats")
out("Example:")
out("  window | recent -> window(source, size=5)")
out("  recent.add('event')")
out("  recent.full()     # check if window is full")
out()

out("=== 6. VIEW - Zero-Copy Slice ===")
out("Immutable view into list (no copying)")
out("Perfect for: chain filters/maps, huge data processing")
out("Example:")
out("  list | big -> [1..1000]")
out("  view | middle -> big.view(200..800)")
out("  # No memory copy!")
out()

out("=== 7. PRIO - Priority Queue ===")
out("Min-heap with O(log n) operations")
out("Perfect for: scheduling, Dijkstra, A*, task queues")
out("Example:")
out("  prio | tasks -> prio()")
out("  tasks.push((3, 'low'))")
out("  tasks.push((1, 'urgent'))")
out("  tasks.pop()       # (1, 'urgent')")
out()

out("=== 8. DIFF - Difference List ===")
out("Immutable list with O(1) append")
out("Perfect for: Git-like history, undo stacks, persistent data")
out("Example:")
out("  diff | history -> diff()")
out("  history = history + 'change 1'")
out("  history = history + 'change 2'  # O(1)!")
out("  history.materialize()  # compute final list")
out()

out("========================================")
out("REAL-WORLD COMBO EXAMPLE")
out("========================================\n")

out("Rolling window of errors, auto-sorted by severity:")
out()
out("  prio | errors -> prio()")
out("  window | recent -> window(capacity=50)")
out()  
out("  in log_stream() : {")
out("    if _.contains('ERROR') {")
out("      errors.push((severity(_), _))")
out("      recent.add(_)")
out("      ")
out("      # Alert if >5 critical in last 50")
out("      if recent.count_where(_.severity() > 8) > 5 {")
out("        alert('Critical spike!')")
out("      }")
out("    }")
out("  }")
out()

out("========================================")
out("These types make J as powerful as")
out("NumPy + Rust + Go combined!")
out("========================================")
